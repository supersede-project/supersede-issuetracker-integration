<!--
   (C) Copyright 2015-2018 The SUPERSEDE Project Consortium

   Licensed under the Apache License, Version 2.0 (the "License");
   you may not use this file except in compliance with the License.
   You may obtain a copy of the License at
     http://www.apache.org/licenses/LICENSE-2.0
   Unless required by applicable law or agreed to in writing, software
   distributed under the License is distributed on an "AS IS" BASIS,
   WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   See the License for the specific language governing permissions and
   limitations under the License.
-->

<html>
<head>$webResourceManager.requireResourcesForContext("content-supersede-alerts.context")

</head>
<body>
	<div>
		<h2>Alerts</h2>
		<!-- 		CHECK SUPERSEDE BUTTON -->
		<div class="refreshPane">
			<button class="aui-button aui-button-secondary check-alerts simple-tooltip" title="Check supersede for new alerts added after you opened this application">
				<span class="glyphicon glyphicon-repeat"></span> $i18n.getText("supersede-alerts-check-supersede.label")
			</button>
		</div>
		<!-- 		SEARCH FIELD AND BUTTON -->
		<div class="searchPane">
			<input name="searchAlertsInput" id="searchAlertsInput" placeholder='$i18n.getText("supersede-alerts-alert-search.placeholder")'>
			<button class="aui-button aui-button-primary searchBtn">
				<span class="glyphicon glyphicon-search"></span>
			</button>
		</div>
	</div>

	<!-- 	DATA TABLE -->
	<div id="data-section">
		<div class="p-list">
			<table class="aui table-truncate aui-table-sortable sortableTable">
				<thead>
					<tr>
						<th class="td-tiny"></th>
						<th class="td-med">$i18n.getText("supersede-alerts-table-id.label")</th>
						<th class="td-small">$i18n.getText("supersede-alerts-table-app-id.label")</th>
						<th class="td-med">$i18n.getText("supersede-alerts-table-timestamp.label")</th>
						<th class="td-max">$i18n.getText("supersede-alerts-table-description.label")</th>
						<th class="td-tiny">$i18n.getText("supersede-alerts-table-positive.label")</th>
						<th class="td-tiny">$i18n.getText("supersede-alerts-table-negative.label")</th>
						<th class="td-tiny">$i18n.getText("supersede-alerts-table-sentiment.label")</th>
						<th class="td-med">$i18n.getText("supersede-alerts-table-attachment.label")</th>
					</tr>
				</thead>
				<tbody class="projects-list">
					#foreach( $alert in $alerts )
					<tr>
						<td class="td-truncate"><input class="chkSelected checkbox" type="checkbox" id=$alert.getId()></td>
						<td class="td-truncate alertId"><a href="supersede-alerts?xmlAlert=y&xmlAlertId=$alert.getId()" target="_blank">$alert.getId()</a></td>
						<td class="td-truncate">$alert.getApplicationId()</td>
						<td class="td-truncate">$alert.getTimestamp()</td>
						<td class="td-truncate">$alert.getDescription()</td>
						<td class="td-truncate">$alert.getPositive()</td>
						<td class="td-truncate">$alert.getNegative()</td>
						<td class="td-truncate">$alert.getSentiment()</td>
						<td class="td-truncate"><a data-aui-trigger aria-controls=$alert.getFilteredId() href="#">$alert.getCount()</a> <!-- 						INLINE DIALOG (RELATED TO ROW)  --> <aui-inline-dialog id=$alert.getFilteredId()> #foreach( $issue in
							$alert.getIssues())
							<table>
								<tbody>
									<tr>
										<a href="$baseurl/browse/$issue">$issue</a>
									</tr>
								</tbody>
							</table>
							#end </aui-inline-dialog></td>
					</tr>
					#end
				</tbody>
			</table>

			<!-- PROJECT SELECTION IMPORT DIALOG -->
			<section role="dialog" id="import-dialog" class="aui-layer aui-dialog2 aui-dialog2-medium" aria-hidden="true">
				<!-- Dialog header -->
				<header class="aui-dialog2-header">
					<!-- The dialog's title -->
					<h2 class="aui-dialog2-header-main">$i18n.getText("supersede-alerts-project.title")</h2>
					<!-- Close icon -->
					<a class="aui-dialog2-header-close"> <span class="aui-icon aui-icon-small aui-iconfont-close-dialog">$i18n.getText("supersede-alerts-close.btn.label")</span>
					</a>

				</header>
				<!-- Main dialog content -->
				<div class="aui-dialog2-content">
					Select the project where the selected alert(s) will be added as issue(s), and the type the issue will get. <br> <br>
					<form class="aui">
						<aui-label for="project-select-import">$i18n.getText("supersede-alerts-project-import.label")</aui-label>
						<select id="project-select-import"> #foreach($project in $projects)
							<option value=$project.getKey()>$project.getKey()</option> #end
						</select>
					</form>
					<br>
					<div id='issue-type'>#parse("/templates/content-supersede-alerts-issue-type.vm")</div>
				</div>
				<!-- Dialog footer -->
				<footer class="aui-dialog2-footer">
					<!-- Actions to render on the right of the footer -->
					<div class="aui-dialog2-footer-actions">
						<form action="supersede-alerts" method="get">
							<input type="hidden" class="selectionList" name="selectionList">
							<input type="checkbox" id="chkDeleteStatus" class="toEnable" class="chkDeleteStatus" name="chkDeleteStatus" value="true" />$i18n.getText("supersede-alerts-delete-chekbox.label") 
							<input type="hidden" class="projectField" value=$projectField name="projectField">
							<button id="dialog-submit-button" class="aui-button aui-button-primary dialogButton" name="action" value="Import">$i18n.getText("supersede-alerts-create-btn.label")</button>
						</form>
					</div>
					<!-- HINT TEXT -->
				</footer>
			</section>


			<!-- ATTACH DIALOG -->
			<section role="dialog" id="attach-dialog" class="aui-layer aui-dialog2 aui-dialog2-medium" aria-hidden="true">
				<!-- Dialog header -->
				<header class="aui-dialog2-header">
					<!-- The dialog's title -->
					<h2 class="aui-dialog2-header-main">$i18n.getText("supersede-alerts-issue.title")</h2>
					<!-- Actions to render on the right of the header -->
					<!-- Close icon -->
					<a class="aui-dialog2-header-close"> <span class="aui-icon aui-icon-small aui-iconfont-close-dialog">$i18n.getText("supersede-alerts-close.btn.label")</span>
					</a>
				</header>
				<!-- Main dialog content -->
				<div class="aui-dialog2-content">

					<div>
						Select the project containing the target issue where this alert will be attached. <br> You can use the search box in order to filter results.
					</div>

					<form class="aui">
						<select id="project-select-attach" style="float: left; width: 200px;"> #foreach($project in $projects)
							<option value=$project.getKey()>$project.getKey()</option> #end
						</select>
					</form>
					<div class="searchPaneDialog" style="float: right;">
						<input name="searchIssuesDialogInput" id="searchIssuesDialogInput" placeholder='$i18n.getText("supersede-alerts-issue-search.placeholder")'>
						<button class="aui-button aui-button-primary searchBtnDialog">
							<span class="glyphicon glyphicon-search"></span>
						</button>
					</div>
					<div id='attach-dialog-data'>#parse("/templates/attach-dialog-data.vm")</div>
				</div>
				<!-- Dialog footer -->
				<footer class="aui-dialog2-footer">
					<!-- Actions to render on the right of the footer -->
					<div class="aui-dialog2-footer-actions">
						<form action="supersede-alerts" method="get">
							<input type="hidden" class="projectField" value=$projectField name="projectField"> <input type="hidden" class="selectionList" name="selectionList"> <input type="hidden" id="issuesSelectionList" name="issuesSelectionList"> 
							<input type="checkbox" id="chkDeleteStatus" class="toEnable" class="chkDeleteStatus" name="chkDeleteStatus" value="true" />$i18n.getText("supersede-alerts-delete-chekbox.label")
							<button id="dialog-submit-button" class="aui-button aui-button-primary dialogButton toEnableDialog" name="action" value="Attach">$i18n.getText("supersede-alerts-attach-dialog-btn.label")</button>
						</form>
						<button id="dialog-close-button" class="aui-button aui-button-link">$i18n.getText("supersede-alerts-close.btn.label")</button>
					</div>
					<!-- HINT TEXT -->
				</footer>
			</section>

			<!-- DELETE DIALOG -->
			<section role="dialog" id="delete-dialog" class="aui-layer aui-dialog2 aui-dialog2-medium aui-dialog2-warning" aria-hidden="true">
				<!-- Dialog header -->
				<header class="aui-dialog2-header">
					<h2 class="aui-dialog2-header-main">$i18n.getText("supersede-alerts-delete-dialog.title")</h2>
					<!-- Close icon -->
					<a class="aui-dialog2-header-close"> <span class="aui-icon aui-icon-small aui-iconfont-close-dialog">Close</span>
					</a>
				</header>
				<!-- Main dialog content -->
				<div class="aui-dialog2-content dialogDataView"></div>
				<!-- Dialog footer -->
				<footer class="aui-dialog2-footer">
					<!-- Actions to render on the right of the footer -->
					<div class="aui-dialog2-footer-actions">
						<form action="supersede-alerts" method="post">
							<input type="hidden" class="selectionList" name="selectionList"> <input type="submit" id="dialog-submit-button" class="aui-button aui-button-primary dialogButton" name="deleteAction" value="Delete">
						</form>
						<button id="dialog-close-button" class="aui-button aui-button-link">Close</button>
					</div>
					<!-- HINT TEXT -->
				</footer>
			</section>

			<!-- 			IMPORT - ATTACH - DELETE BUTTONS  -->
			<div class="aui-group">
				<div style="float: left" class="aui-item buttonPane">
					<button style="margin-left: 20px" id="import-dialog-show-button" name="action" value="Import" class="aui-button aui-button-primary alertManagement toEnable simple-tooltip" title="Create new issue from selected alert(s)">
						<span class="glyphicon glyphicon-plus"></span> <span class="submit-text">$i18n.getText("supersede-alerts-create-btn.label")</span>
					</button>
					<button style="margin-left: 20px" id="attach-dialog-show-button" class="aui-button aui-button-primary alertManagement toEnable simple-tooltip" title="Attach selected alert to existing issue(s)">
						<span class="glyphicon glyphicon-paperclip"></span> $i18n.getText("supersede-alerts-attach-btn.label")
					</button>
					<button id="dialog-delete-button" class="aui-button aui-button-secondary alertManagement toEnable simple-tooltip" title='$i18n.getText("supersede-alerts-delete-btn.tooltip")'>
						<span class="glyphicon glyphicon-trash"></span> $i18n.getText("supersede-alerts-delete-btn.label")
					</button>
				</div>
			</div>
		</div>
	</div>
</body>
</html>
